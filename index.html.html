<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Juego del Impostor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #0f172a;
      --card-bg: #111827;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.1);
      --danger: #f97373;
      --text-main: #e5e7eb;
      --text-soft: #9ca3af;
      --border: #1f2937;
      --radius-lg: 18px;
      --radius-md: 10px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1e293b 0, #020617 45%, #000 100%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: linear-gradient(145deg, #020617 0%, #020617 40%, #111827 100%);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.65),
        0 0 0 1px rgba(15, 23, 42, 0.9);
      padding: 20px 18px 22px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
      gap: 10px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    h1 {
      font-size: 1.35rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-weight: 700;
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .pill {
      border-radius: 999px;
      padding: 4px 10px;
      background: radial-gradient(circle at top, #22c55e33, #22c55e11);
      border: 1px solid #22c55e44;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 8px #22c55e;
    }

    .card {
      background: rgba(15, 23, 42, 0.95);
      border-radius: var(--radius-lg);
      padding: 14px 14px 12px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      margin-bottom: 10px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .card-caption {
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
      margin-bottom: 10px;
    }

    label {
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    input[type="number"],
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: #020617;
      color: var(--text-main);
      font-size: 0.9rem;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s, background 0.15s;
    }

    input[type="number"]:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
      background: #02091b;
    }

    .inline-fields {
      display: flex;
      gap: 8px;
    }

    .inline-fields .field-group {
      flex: 1;
    }

    button {
      width: 100%;
      padding: 9px 12px;
      border-radius: 999px;
      border: none;
      outline: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out,
        background 0.12s, opacity 0.12s;
    }

    .btn-primary {
      background: radial-gradient(circle at top, #22c55e, #16a34a);
      color: #02120a;
      box-shadow:
        0 10px 20px rgba(22, 163, 74, 0.35),
        0 0 0 1px rgba(21, 128, 61, 0.8);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow:
        0 4px 10px rgba(22, 163, 74, 0.35),
        0 0 0 1px rgba(21, 128, 61, 0.7);
    }

    .btn-secondary {
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      border: 1px solid rgba(148, 163, 184, 0.2);
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.9);
    }

    .btn-secondary:active {
      transform: translateY(1px);
      box-shadow: 0 2px 5px rgba(15, 23, 42, 0.9);
    }

    .small-note {
      margin-top: 6px;
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .hint {
      font-size: 0.78rem;
      color: var(--text-soft);
      margin-top: 6px;
      line-height: 1.3;
    }

    .hint strong {
      color: var(--accent);
    }

    .game-section {
      margin-top: 8px;
    }

    .player-info {
      font-size: 0.85rem;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: var(--text-soft);
    }

    .player-info span strong {
      color: var(--accent);
    }

    .word-box {
      margin: 8px 0 10px;
      min-height: 72px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 16px;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      background: radial-gradient(circle at top, #0b1120, #020617);
      padding: 10px;
      text-align: center;
    }

    .word-text {
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .word-text.impostor {
      color: var(--danger);
      text-shadow: 0 0 12px rgba(248, 113, 113, 0.8);
    }

    .word-helper {
      font-size: 0.75rem;
      color: var(--text-soft);
      margin-top: 4px;
      text-align: center;
    }

    .status-line {
      margin-top: 6px;
      font-size: 0.78rem;
      color: var(--text-soft);
      text-align: center;
    }

    .status-line span {
      color: var(--accent);
      font-weight: 500;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .chip {
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(51, 65, 85, 0.9);
      color: #e5e7eb;
    }

    .footer {
      margin-top: 6px;
      text-align: center;
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .error {
      color: var(--danger);
      font-size: 0.75rem;
      margin-bottom: 4px;
    }

    @media (max-width: 480px) {
      .app {
        padding: 16px 14px 18px;
        border-radius: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-block">
        <h1>El Impostor</h1>
        <div class="subtitle">P√°salo de mano en mano. Que nadie mire.</div>
      </div>
      <div class="pill">
        <span class="pill-dot"></span>
        Modo palabra
      </div>
    </header>

    <!-- Configuraci√≥n -->
    <section class="card" id="config-section">
      <div class="card-header">
        <div>
          <div class="card-title">Configuraci√≥n de la ronda</div>
          <div class="card-caption">Elige cu√°ntos juegan y los impostores.</div>
        </div>
      </div>

      <div id="error-box" class="error" style="display:none;"></div>

      <div class="inline-fields">
        <div class="field-group">
          <label for="numPlayers">N√∫mero de jugadores</label>
          <input
            id="numPlayers"
            type="number"
            min="2"
            max="30"
            value="6"
          />
        </div>
        <div class="field-group">
          <label for="numImpostors">Impostores</label>
          <input
            id="numImpostors"
            type="number"
            min="1"
            max="10"
            value="1"
          />
        </div>
      </div>

      <div class="field-group">
        <label for="categorySelect">Categor√≠a de palabras</label>
        <select id="categorySelect"></select>
      </div>

      <button class="btn-primary" id="startGameBtn">Empezar ronda</button>

      <p class="small-note">
        Consejo: los jugadores se sientan en c√≠rculo, ponen un orden y solo la
        persona que tiene el celular puede mirar la pantalla.
      </p>

      <div class="hint">
        Se elegir√° una <strong>palabra secreta</strong>. Todos la ver√°n excepto
        uno o varios <strong>impostores</strong>, que solo sabr√°n que son
        impostores pero no la palabra. Luego ¬°a discutir pistas y descubrirlos!
      </div>
    </section>

    <!-- Juego -->
    <section class="card game-section" id="game-section" style="display:none;">
      <div class="card-header">
        <div>
          <div class="card-title">Turno actual</div>
          <div class="card-caption" id="roundInfo"></div>
        </div>
      </div>

      <div class="player-info">
        <span id="playerLabel"></span>
        <span id="categoryLabel"></span>
      </div>

      <div class="word-box">
        <div>
          <div id="wordText" class="word-text"></div>
          <div id="wordHelper" class="word-helper"></div>
        </div>
      </div>

      <button class="btn-primary" id="seeWordBtn">
        Mostrar mi palabra
      </button>

      <div class="status-line" id="statusLine"></div>

      <button
        class="btn-secondary"
        id="newRoundBtn"
        style="margin-top: 10px; display:none;"
      >
        Nueva ronda con esta configuraci√≥n
      </button>

      <div class="chips">
        <div class="chip" id="chipPlayers"></div>
        <div class="chip" id="chipImpostors"></div>
        <div class="chip" id="chipWordMode"></div>
      </div>
    </section>

    <div class="footer">
      Despu√©s de que todos vean su rol, deja el celular boca abajo y empieza la
      discusi√≥n.
    </div>
  </div>

  <script>
    // ======= Banco de palabras (6+ categor√≠as, 100+ palabras) =======
    const WORD_CATEGORIES = {
      "Aleatorio": [], // se llena din√°micamente
      "Comida": [
        "pizza", "hamburguesa", "taco", "sushi", "arepa", "empanada",
        "pasta", "lasa√±a", "panqueque", "ensalada", "sancocho", "bandeja",
        "helado", "chocolate", "torta", "cereal", "hot dog", "paella",
        "ceviche", "frijoles", "arroz", "sandwich", "caf√©", "t√©",
        "limonada", "brownie", "galletas", "churro", "bu√±uelo", "tamales"
      ],
      "Animales": [
        "perro", "gato", "tigre", "le√≥n", "√°guila", "delf√≠n", "tibur√≥n",
        "ballena", "elefante", "jirafa", "mono", "oso", "ping√ºino",
        "koala", "lobo", "zorro", "caballo", "vaca", "oveja", "cerdo",
        "pollo", "gallina", "pato", "gallo", "ardilla", "conejo", "tortuga",
        "serpiente", "cangrejo", "mariposa"
      ],
      "Lugares": [
        "playa", "monta√±a", "bosque", "desierto", "ciudad", "pueblo",
        "escuela", "universidad", "cine", "teatro", "parque", "museo",
        "aeropuerto", "estaci√≥n", "biblioteca", "estadio", "restaurante",
        "cafeter√≠a", "supermercado", "hospital", "hotel", "iglesia",
        "casa", "apartamento", "oficina", "gimnasio", "plaza",
        "mercado", "centro comercial", "carretera"
      ],
      "Objetos": [
        "celular", "computador", "c√°mara", "reloj", "llave", "cuaderno",
        "l√°piz", "bol√≠grafo", "mochila", "billetera", "gafas", "cuchara",
        "tenedor", "cuchillo", "silla", "mesa", "l√°mpara", "control",
        "televisor", "aud√≠fonos", "botella", "vaso", "taza", "paraguas",
        "zapato", "chaqueta", "bal√≥n", "bicicleta", "patineta", "libro"
      ],
      "Profesiones": [
        "m√©dico", "enfermero", "maestro", "ingeniero", "arquitecto",
        "fot√≥grafo", "chef", "cantante", "actor", "abogado", "polic√≠a",
        "bombero", "piloto", "dise√±ador", "programador", "periodista",
        "carpintero", "electricista", "plomero", "panadero", "barbero",
        "mesero", "veterinario", "psic√≥logo", "deportista", "bailar√≠n",
        "pintor", "mec√°nico", "farmac√©utico", "dentista"
      ],
      "Cine / Series": [
        "superh√©roe", "terror", "comedia", "drama", "documental",
        "animaci√≥n", "ciencia ficci√≥n", "romance", "western", "musical",
        "zombi", "espionaje", "fantas√≠a", "polic√≠aco", "thriller",
        "superh√©roes", "subt√≠tulos", "palomitas", "director", "actor",
        "villano", "protagonista", "secundario", "soundtrack", "remake",
        "spin-off", "temporada", "episodio", "streaming", "marat√≥n"
      ]
    };

    // Llenar categor√≠a "Aleatorio" con todas las palabras
    const allWords = Object.entries(WORD_CATEGORIES)
      .filter(([name]) => name !== "Aleatorio")
      .flatMap(([, words]) => words);
    WORD_CATEGORIES["Aleatorio"] = allWords;

    // ======= Estado del juego =======
    let totalPlayers = 0;
    let totalImpostors = 0;
    let currentPlayer = 0;
    let impostorIndices = [];
    let secretWord = "";
    let currentCategory = "";

    // ======= Elementos del DOM =======
    const categorySelect = document.getElementById("categorySelect");
    const numPlayersInput = document.getElementById("numPlayers");
    const numImpostorsInput = document.getElementById("numImpostors");
    const startGameBtn = document.getElementById("startGameBtn");
    const configSection = document.getElementById("config-section");
    const gameSection = document.getElementById("game-section");
    const errorBox = document.getElementById("error-box");

    const roundInfo = document.getElementById("roundInfo");
    const playerLabel = document.getElementById("playerLabel");
    const categoryLabel = document.getElementById("categoryLabel");
    const wordText = document.getElementById("wordText");
    const wordHelper = document.getElementById("wordHelper");
    const seeWordBtn = document.getElementById("seeWordBtn");
    const statusLine = document.getElementById("statusLine");
    const newRoundBtn = document.getElementById("newRoundBtn");
    const chipPlayers = document.getElementById("chipPlayers");
    const chipImpostors = document.getElementById("chipImpostors");
    const chipWordMode = document.getElementById("chipWordMode");

    // ======= Inicializaci√≥n de categor√≠as =======
    function initCategories() {
      for (const categoryName of Object.keys(WORD_CATEGORIES)) {
        const option = document.createElement("option");
        option.value = categoryName;
        option.textContent = categoryName;
        categorySelect.appendChild(option);
      }
      categorySelect.value = "Aleatorio";
    }

    initCategories();

    // ======= Utilidades =======
    function shuffleArray(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function showError(msg) {
      errorBox.textContent = msg;
      errorBox.style.display = "block";
    }

    function clearError() {
      errorBox.textContent = "";
      errorBox.style.display = "none";
    }

    // ======= L√≥gica principal =======
    function startRound() {
      clearError();

      const nPlayers = parseInt(numPlayersInput.value, 10);
      const nImpostors = parseInt(numImpostorsInput.value, 10);
      const selectedCategory = categorySelect.value;

      if (isNaN(nPlayers) || isNaN(nImpostors)) {
        showError("Verifica que los campos de jugadores e impostores tengan n√∫meros v√°lidos.");
        return;
      }

      if (nPlayers < 2) {
        showError("El juego necesita al menos 2 jugadores.");
        return;
      }

      if (nImpostors < 1) {
        showError("Debe haber al menos 1 impostor.");
        return;
      }

      if (nImpostors >= nPlayers) {
        showError("El n√∫mero de impostores debe ser menor que el de jugadores.");
        return;
      }

      const wordsInCategory = WORD_CATEGORIES[selectedCategory];
      if (!wordsInCategory || wordsInCategory.length === 0) {
        showError("No hay palabras disponibles para esta categor√≠a.");
        return;
      }

      totalPlayers = nPlayers;
      totalImpostors = nImpostors;
      currentCategory = selectedCategory;
      currentPlayer = 0;

      // Elegir palabra secreta
      const randomIndex = Math.floor(Math.random() * wordsInCategory.length);
      secretWord = wordsInCategory[randomIndex];

      // Elegir impostores
      const indices = Array.from({ length: totalPlayers }, (_, i) => i);
      const shuffled = shuffleArray(indices);
      impostorIndices = shuffled.slice(0, totalImpostors).sort((a, b) => a - b);

      // Actualizar UI y comenzar
      configSection.style.display = "none";
      gameSection.style.display = "block";

      chipPlayers.textContent = `Jugadores: ${totalPlayers}`;
      chipImpostors.textContent = `Impostores: ${totalImpostors}`;
      chipWordMode.textContent = `Modo: palabra √∫nica`;

      roundInfo.textContent = `Palabra secreta elegida. Nadie debe verla m√°s de lo debido. üòâ`;
      categoryLabel.textContent = `Categor√≠a: ${currentCategory}`;
      newRoundBtn.style.display = "none";

      resetPlayerView();
    }

    function isCurrentPlayerImpostor() {
      return impostorIndices.includes(currentPlayer);
    }

    function resetPlayerView() {
      // Vista antes de ver la palabra
      playerLabel.textContent = `Jugador ${currentPlayer + 1} de ${totalPlayers}`;
      wordText.textContent = "Toca el bot√≥n para ver tu rol.";
      wordText.classList.remove("impostor");
      wordHelper.textContent = "Solo t√∫ puedes mirar. Luego pulsa para pasar el celular al siguiente.";
      statusLine.textContent = `Turno del jugador ${currentPlayer + 1}.`;

      seeWordBtn.textContent = "Mostrar mi palabra";
      seeWordBtn.dataset.state = "hidden";
    }

    function showCurrentPlayerWord() {
      const impostor = isCurrentPlayerImpostor();

      if (seeWordBtn.dataset.state === "hidden") {
        // Mostrar palabra / rol
        if (impostor) {
          wordText.textContent = "¬°ERES EL IMPOSTOR!";
          wordText.classList.add("impostor");
          wordHelper.textContent =
            "No sabes la palabra. Escucha pistas y finge que la conoces.";
        } else {
          wordText.textContent = secretWord;
          wordText.classList.remove("impostor");
          wordHelper.textContent =
            "Memoriza esta palabra. No la digas literal, solo da pistas.";
        }

        seeWordBtn.textContent = "Ocultar y pasar al siguiente";
        seeWordBtn.dataset.state = "shown";

        statusLine.textContent = `Jugador ${currentPlayer + 1}, memoriza tu rol y luego pasa el tel√©fono.`;
      } else {
        // Ocultar y pasar al siguiente
        currentPlayer++;

        if (currentPlayer >= totalPlayers) {
          endRoundView();
        } else {
          resetPlayerView();
        }
      }
    }

    function endRoundView() {
      wordText.textContent = "Todos tienen su rol.";
      wordText.classList.remove("impostor");
      wordHelper.textContent =
        "Pon el celular boca abajo. Ahora hablen por turnos y traten de descubrir a los impostores.";
      seeWordBtn.style.display = "none";
      statusLine.innerHTML =
        "Sugerencia: cada persona dice una pista corta relacionada con la palabra.<br/>Luego votan por qui√©n creen que es el impostor.";
      newRoundBtn.style.display = "block";
      playerLabel.textContent = "Ronda lista";
    }

    function prepareNewRoundSameConfig() {
      // Reutilizar los datos de configuraci√≥n actuales
      gameSection.style.display = "none";
      configSection.style.display = "block";
      clearError();
      // No cambiamos valores: el usuario puede ajustar si quiere
    }

    // ======= Eventos =======
    startGameBtn.addEventListener("click", startRound);
    seeWordBtn.addEventListener("click", showCurrentPlayerWord);
    newRoundBtn.addEventListener("click", () => {
      // Solo volvemos a la configuraci√≥n visual; para una nueva ronda
      // el usuario simplemente vuelve a pulsar "Empezar ronda"
      seeWordBtn.style.display = "block";
      prepareNewRoundSameConfig();
    });
  </script>
</body>
</html>